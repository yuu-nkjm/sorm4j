package org.nkjmlab.sorm4j.internal.result;

import static org.assertj.core.api.Assertions.assertThat;

import java.util.List;

import org.junit.jupiter.api.Test;
import org.nkjmlab.sorm4j.Sorm;
import org.nkjmlab.sorm4j.context.common.TableMetaData;
import org.nkjmlab.sorm4j.test.common.Guest;
import org.nkjmlab.sorm4j.test.common.SormTestUtils;

class TableMetaDataImplTest {

  @Test
  void testTableMetaDataImpl() {
    Sorm sorm = SormTestUtils.createSormWithNewDatabaseAndCreateTables();
    TableMetaData metaData = sorm.getTableMetaData(Guest.class);

    assertThat(metaData.toString()).contains("GUESTS");
    assertThat(metaData.getAutoGeneratedColumns().size()).isEqualTo(1);

    assertThat(metaData.getColumns()).containsAll(List.of("ID", "NAME", "ADDRESS"));
    assertThat(metaData.getPrimaryKeys()).containsAll(List.of("ID"));
  }
}
